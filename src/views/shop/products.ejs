<%- include('./includes/head.ejs') %>
  </head>

  <body>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.css"
      integrity="sha512-OQDNdI5rpnZ0BRhhJc+btbbtnxaj+LdQFeh0V9/igiEPDiWE2fG+ZsXl0JEH+bjXKPJ3zcXqNyP4/F/NegVdZg=="
      crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/shop/css/products.css">
    <%- include('./includes/navigator.ejs') %>

      <main>
        <%- include('./includes/main.ejs') %>

          <section class="page-path">
            <div class="font-regular-light"><a href="#">Home</a> > <a href="#">
                <%= pagePath %>
              </a></div>
            <h2 class="font-lg-regular">
              <%= productType %>
            </h2>
          </section>

          <section class="products">
            <div class="container">
              <div class="products-actions">
                <button class="product-actions__filter-btn" id="products-filter-btn">
                  <i class="ri-sound-module-line"></i>
                </button>
                <div class="product__actions__sort-products">

                </div>
              </div>
              <div class="products-list" id="products-list">
                <% if (products.length> 0) { %>
                  <% for (product of products) { %>
                    <div class="product-card">
                      <div class="product-card__overly"></div>
                      <div class="product-card__head">
                        <img class="product-card__img" src="<%= product.images[0] %>" alt="<%= product.title %>">
                      </div>
                      <div class="break-line"></div>
                      <div class="product-card__body">
                        <p class="product-card__title">
                          <%= product.title %>
                        </p>
                      </div>
                      <div class="break-line"></div>
                      <div class="product-card__tail">
                        <p class="product-card__price">
                          <%= product.price %>$
                        </p>
                      </div>
                      <div class="product-card__actions">
                        <i class="fa-solid fa-cart-plus fa-lg"></i>
                        <i class="fa-regular fa-heart fa-lg"></i>
                      </div>
                    </div>
                    <% } %>
                      <% } else { %>
                        <h2>No products are founded!</h2>
                        <% } %>
              </div>
            </div>

              <div class="products-list__nav" id="pagenation">
                <% if (isPreviousPage){ %>
                  <a href="/products/<%= pagePath %>/<%= productType %>?p=<%= previousPage %>"
                    class="btn btn--products-list-btn"><i class="ri-arrow-left-line"></i> Previous
                    <input type="hidden" name="page" class="page-value" value="<%=previousPage%>">
                  </a>
                <% } %>
                <% if (currentPage !==1 && previousPage !==1) { %>
                  <a href="/products/<%= pagePath %>/<%= productType %>?p=1" class="btn btn--products-list-btn">1
                    <input type="hidden" name="page" class="page-value" value="1">
                  </a>
                <% } %>
                <% if(currentPage > 3) { %>
                  <div class="products-list-void-btn">...</div>
                <% } %>
                <% if (isPreviousPage){ %>
                  <a href="/products/<%= pagePath %>/<%= productType %>?p=<%= previousPage %>" class="btn btn--products-list-btn"><%= previousPage %>
                    <input type="hidden" name="page" class="page-value" value="<%= previousPage %>">
                  </a>
                <% } %>
                <% if (lastPage > 1) {%>
                  <a href="/products/<%= pagePath %>/<%= productType %>?p=<%= currentPage %>" class="btn btn--products-list-btn <%= 'current-page' %>"><%= currentPage %>
                    <input type="hidden" name="page" class="page-value" value="<%= currentPage %>">
                  </a>
                <% } %>
                <% if (isNextPage && nextPage !== lastPage){ %> 
                  <a href="/products/<%= pagePath %>/<%= productType %>?p=<%= nextPage %>" class="btn btn--products-list-btn"><%= nextPage %>
                    <input type="hidden" name="page" class="page-value" value="<%= nextPage %>">
                  </a>
                <% } %>
                <% if (currentPage < lastPage - 2) { %>
                  <div class="products-list-void-btn">...</div>
                <% } %>
                <% if(lastPage !== currentPage && lastPage !== 1) {%>
                  <a href="/products/<%= pagePath %>/<%= productType %>?p=<%= lastPage %>" class="btn btn--products-list-btn"><%= lastPage %>
                    <input type="hidden" name="page" class="page-value" value="<%= lastPage %>">
                  </a>
                <% } %>
                <% if (isNextPage){ %>   
                  <a href="/products/<%= pagePath %>/<%= productType %>?p=<%= nextPage %>" class="btn btn--products-list-btn">Next <i class="ri-arrow-right-line"></i>
                    <input type="hidden" name="page" class="page-value" value="<%= nextPage %>">
                  </a>
                <% } %>
              </div>
          </section>

          <section class="products-filter" id="products-filter">
            <div class="products-filter__overly" id="products-filter-overly"></div>
            <div class="products-filter__wrapper">
              <button class="close-btn" id="products-filter-close-btn">
                <div class="close-icon"></div>
              </button>
              <div class="products-filter__body">
                <form action="#" method="get" id="filter-form">
                  <% for (filter of filterOptions) { %>
                    <div class="products-filter__body-element" id="<%= filter.name.replaceAll(' ', '') %>">
                      <p class="products-filter__element-title"><%= filter.name %></p>
                      <% for (op of filter.values) { %>
                        <label>
                          <input type="<%= filter.type %>" name="<%= filter.name %>" id="filter-input" value="<%= op.name %>" <% if (op.status) {%> <%- 'checked' %> <%}%> >
                          <span class="check-mark">
                            <i class="fa-solid fa-check"></i>
                          </span>
                          <div class="products-filter__filter-label">
                            <p><%= op.name %></p>
                            <p class="products-count">(<%= op.count %>)</p>
                          </div>
                        </label>
                      <% } %>
                    </div>
                  <% } %>
                  <% if (pagePath === 'categories') { %>
                    <input type="hidden" name="category" value="<%= productType %>">
                    <input type="hidden" name="pageType" id="page-type" value="categories">
                  <% } else { %>
                    <input type="hidden" name="pageType" id="page-type" value="brands">
                    <input type="hidden" name="brandMain" value="<%= productType %>">
                  <% }%>
                </form>
              </div>
            </div>
          </section>

      </main>
      <script src="/shop/js/products.js"></script>
      <%- include('./includes/end.ejs') %>